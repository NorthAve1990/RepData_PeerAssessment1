---
title: "PA1 Template"
author: "Sridhar Somasundharam"
date: "Wednesday, January 14, 2014"
output: html_document
---
Loading and preprocessing the data

1. Load the data (i.e. read.csv())
2. Process/transform the data (if necessary) into a format suitable for your analysis

```{r, echo=FALSE}
getwd()
setwd("C:/Users/ssomasundharam/Documents/Data Science/Coursera R/Reproducible Research")
```

What is mean total number of steps taken per day?

1. Make a histogram of the total number of steps taken each day
2. Calculate and report the mean and median total number of steps taken per day

```{r, echo=FALSE}

acdata <- read.csv("activity.csv")
acompe <- acdata[complete.cases(acdata),]
library(data.table)
acdate <- data.table(acompe)
acstep <- acdate[,sum(steps), by="date"]
library(ggplot2)
ggplot(acstep, aes(x = V1)) + geom_histogram() + xlab("Steps Taken Per Day")
```

## Mean and Median value for Total steps

```{r, echo=FALSE}
mean(acstep$V1)
median(acstep$V1)

```

```{r, echo=FALSE}

acmean <- acdate[,mean(steps), by="interval"]
ggplot(acmean, aes(x = interval, y = V1)) + geom_line() + ylab("Average Steps")

```

## Mean and Median value for Average steps

```{r, echo=FALSE}
mean(acmean$V1)
median(acmean$V1)

```

```{r, echo=FALSE}

# atstep[is.na(atstep)] <- 0
# median(atstep)

```

What is the average daily activity pattern?

    Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

    Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r, echo=FALSE}

acdata <- read.csv("activity.csv")
day <- weekdays(as.Date(acdata$date))
wday <- as.POSIXlt(acdata$date)$wday
wd <- subset(acdata, wday != "0" | wday != "6")
plot(interval ~ date, wd, type = "l", main = "Average Number of Steps Taken")

```

Sort by date and interval

```{r, echo=FALSE}

plot(steps ~ interval, wd, type = "l", main = "Average Number of Steps Taken")

```

Renumber row names
```{r, echo=FALSE}

plot.ts(wd, ylab = "Interval", main = "Average Number of Steps Taken")

```
